<script>
  async function connectWallet() {
    if (typeof window.ethereum === "undefined") {
      alert("MetaMask not found. Please install it.");
      return;
    }

    try {
      const provider = new ethers.BrowserProvider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = await provider.getSigner();
      const address = await signer.getAddress();

      document.getElementById("status").innerText = `Connected: ${address}`;

      // Send address to Apps Script
      google.script.run
        .withSuccessHandler(() => alert("Wallet connected!"))
        .withFailureHandler((err) => alert("Script error: " + err.message))
        .saveWalletAddress(address);
    } catch (err) {
      alert("Error: " + err.message);
    }
  }
</script>
